/**
 * ATIVIDADE 3 – Introdução ao MongoDB
 */

/**
 * 1. Crie uma collection chamada “vendas” para armazenar documentos contendo as
    seguintes informações:
    a. Nome do produto
    b. Valor unitário do produto
    c. Classificação do produto (
        smartphone, notebook, tablet, monitor, câmera digital, headset,carregador
      )
    d. Quantidade
    e. Nome do cliente
    f. Identificador cliente
    g. Data da venda
 */
db.createCollection("vendas")


/**
 * 02 - Crie uma collection chamada “cliente”, com as seguintes informações: 
 *      a)Nome do cliente 
 *      b)Endereço(pais, cidade, rua, número, complemento) 
 *      c)Contato (email, telefone)
 */
db.createCollection("cliente")


/**
 * 03 - Crie ao menos 10 documentos para collection vendas, 
 *      e ao menos 4 documentos de vendas para cada cliente.
 */

 /**
  * 03a - cria os clientes (20)
  */
db.cliente.insertMany([
  {'contato': {'email': 'eric_ruiz@fakemail.net', 'telefone': '982255875'},
    'endereco': {'cidade': 'Brusque',
               'complemento': '',
               'numero': 203,
               'pais': 'Brasil',
               'rua': 'Rua Bulcão Viana'},
  'nome': 'ERIC RUIZ'},
 {'contato': {'email': 'roberta_de_lima@fakemail.net', 'telefone': '999675919'},
  'endereco': {'cidade': 'Itajaí',
               'complemento': '',
               'numero': 248,
               'pais': 'Brasil',
               'rua': 'Av. Brasil'},
  'nome': 'ROBERTA DE LIMA'},
 {'contato': {'email': 'deividi_scalzavara@fakemail.net',
              'telefone': '981588122'},
  'endereco': {'cidade': 'Navegantes',
               'complemento': '',
               'numero': 976,
               'pais': 'Brasil',
               'rua': 'Rua Uruguai'},
  'nome': 'DEIVIDI SCALZAVARA'},
 {'contato': {'email': 'adolfo_neto@fakemail.net', 'telefone': '989235565'},
  'endereco': {'cidade': 'Brusque',
               'complemento': '',
               'numero': 848,
               'pais': 'Brasil',
               'rua': 'Rua Bulcão Viana'},
  'nome': 'ADOLFO NETO'},
 {'contato': {'email': 'jose_monestel@fakemail.net', 'telefone': '989696400'},
  'endereco': {'cidade': 'Navegantes',
               'complemento': '',
               'numero': 255,
               'pais': 'Brasil',
               'rua': 'Rua Uruguai'},
  'nome': 'JOSE MONESTEL'},
 {'contato': {'email': 'wagner_correia@fakemail.net', 'telefone': '981556261'},
  'endereco': {'cidade': 'Brusque',
               'complemento': '',
               'numero': 903,
               'pais': 'Brasil',
               'rua': 'Rua Uruguai'},
  'nome': 'WAGNER CORREIA'},
 {'contato': {'email': 'jaceguay_zukoski@fakemail.net',
              'telefone': '998021143'},
  'endereco': {'cidade': 'Navegantes',
               'complemento': '',
               'numero': 712,
               'pais': 'Brasil',
               'rua': 'Rua Bulcão Viana'},
  'nome': 'JACEGUAY ZUKOSKI'},
 {'contato': {'email': 'michel_souza@fakemail.net', 'telefone': '992805477'},
  'endereco': {'cidade': 'Florianópolis',
               'complemento': '',
               'numero': 557,
               'pais': 'Brasil',
               'rua': 'Rua das Acácias'},
  'nome': 'MICHEL SOUZA'},
 {'contato': {'email': 'mayra_rodrigues@fakemail.net', 'telefone': '984771380'},
  'endereco': {'cidade': 'Navegantes',
               'complemento': '',
               'numero': 279,
               'pais': 'Brasil',
               'rua': 'Rua das Acácias'},
  'nome': 'MAYRA RODRIGUES'},
 {'contato': {'email': 'michel_duarte@fakemail.net', 'telefone': '984020081'},
  'endereco': {'cidade': 'Navegantes',
               'complemento': '',
               'numero': 393,
               'pais': 'Brasil',
               'rua': 'Av. Brasil'},
  'nome': 'MICHEL DUARTE'},
 {'contato': {'email': 'marcio_fossa@fakemail.net', 'telefone': '991863659'},
  'endereco': {'cidade': 'Itajaí',
               'complemento': '',
               'numero': 725,
               'pais': 'Brasil',
               'rua': 'Av. Brasil'},
  'nome': 'MARCIO FOSSA'},
 {'contato': {'email': 'marcel_bornancin@fakemail.net',
              'telefone': '985775870'},
  'endereco': {'cidade': 'Brusque',
               'complemento': '',
               'numero': 732,
               'pais': 'Brasil',
               'rua': 'Rua das Acácias'},
  'nome': 'MARCEL BORNANCIN'},
 {'contato': {'email': 'eloisa_perin@fakemail.net', 'telefone': '997105655'},
  'endereco': {'cidade': 'Navegantes',
               'complemento': '',
               'numero': 568,
               'pais': 'Brasil',
               'rua': 'Rua Bulcão Viana'},
  'nome': 'ELOISA PERIN'},
 {'contato': {'email': 'tiago_wippel@fakemail.net', 'telefone': '986330851'},
  'endereco': {'cidade': 'Itajaí',
               'complemento': '',
               'numero': 202,
               'pais': 'Brasil',
               'rua': 'Av. Brasil'},
  'nome': 'TIAGO WIPPEL'},
 {'contato': {'email': 'lucas_fischer@fakemail.net', 'telefone': '986109196'},
  'endereco': {'cidade': 'Navegantes',
               'complemento': '',
               'numero': 432,
               'pais': 'Brasil',
               'rua': 'Rua Bulcão Viana'},
  'nome': 'LUCAS FISCHER'},
 {'contato': {'email': 'diego_prando@fakemail.net', 'telefone': '986763087'},
  'endereco': {'cidade': 'Navegantes',
               'complemento': '',
               'numero': 980,
               'pais': 'Brasil',
               'rua': 'Rua Bulcão Viana'},
  'nome': 'DIEGO PRANDO'},
 {'contato': {'email': 'adriano_weiguert_nagasava@fakemail.net',
              'telefone': '988324264'},
  'endereco': {'cidade': 'Navegantes',
               'complemento': '',
               'numero': 539,
               'pais': 'Brasil',
               'rua': 'Rua Uruguai'},
  'nome': 'ADRIANO WEIGUERT NAGASAVA'},
 {'contato': {'email': 'fernando_miranda@fakemail.net',
              'telefone': '987571732'},
  'endereco': {'cidade': 'Navegantes',
               'complemento': '',
               'numero': 233,
               'pais': 'Brasil',
               'rua': 'Av Marcos Konder'},
  'nome': 'FERNANDO MIRANDA'},
 {'contato': {'email': 'luis_montes@fakemail.net', 'telefone': '983013596'},
  'endereco': {'cidade': 'Itajaí',
               'complemento': '',
               'numero': 38,
               'pais': 'Brasil',
               'rua': 'Rua das Acácias'},
  'nome': 'LUIS MONTES'},
 {'contato': {'email': 'marcelo_de_souza@fakemail.net',
              'telefone': '998052721'},
  'endereco': {'cidade': 'Itajaí',
               'complemento': '',
               'numero': 207,
               'pais': 'Brasil',
               'rua': 'Rua Uruguai'},
  'nome': 'MARCELO DE SOUZA'}

])


/**
 * 03b - Cria vendas (104)
 */
db.vendas.insertMany([
  {'classificacao_produto': 'smartphone',
  'data_venda': ISODate('2018-06-10'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1d8'),
  'nome_cliente': 'ERIC RUIZ',
  'nome_produto': 'Xiaomi Redmi',
  'quantidade': 3,
  'valor_unitario': 768.89},
  {'classificacao_produto': 'carregador',
  'data_venda': ISODate('2018-03-12'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1d8'),
  'nome_cliente': 'ERIC RUIZ',
  'nome_produto': 'Qualcomm Turbo 3A',
  'quantidade': 2,
  'valor_unitario': 36.5},
  {'classificacao_produto': 'tablet',
  'data_venda': ISODate('2017-05-12'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1d8'),
  'nome_cliente': 'ERIC RUIZ',
  'nome_produto': 'Acer Iconia',
  'quantidade': 1,
  'valor_unitario': 499.0},
  {'classificacao_produto': 'headset',
  'data_venda': ISODate('2018-12-13'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1d8'),
  'nome_cliente': 'ERIC RUIZ',
  'nome_produto': 'Apple Beats Studio',
  'quantidade': 1,
  'valor_unitario': 1599},
  {'classificacao_produto': 'carregador',
  'data_venda': ISODate('2017-01-12'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1d8'),
  'nome_cliente': 'ERIC RUIZ',
  'nome_produto': 'Universal 3 USB 3A',
  'quantidade': 4,
  'valor_unitario': 27.8},
  {'classificacao_produto': 'monitor',
  'data_venda': ISODate('2017-08-25'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1d8'),
  'nome_cliente': 'ERIC RUIZ',
  'nome_produto': 'Philips LED 185',
  'quantidade': 2,
  'valor_unitario': 269.9},
  {'classificacao_produto': 'headset',
  'data_venda': ISODate('2019-06-27'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1d9'),
  'nome_cliente': 'ROBERTA DE LIMA',
  'nome_produto': 'Sony MDR-5A',
  'quantidade': 1,
  'valor_unitario': 414.62},
  {'classificacao_produto': 'notebook',
  'data_venda': ISODate('2019-11-21'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1d9'),
  'nome_cliente': 'ROBERTA DE LIMA',
  'nome_produto': 'Mac Book Air',
  'quantidade': 2,
  'valor_unitario': 4680.0},
  {'classificacao_produto': 'headset',
  'data_venda': ISODate('2018-03-26'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1d9'),
  'nome_cliente': 'ROBERTA DE LIMA',
  'nome_produto': 'Sony MDR-5A',
  'quantidade': 2,
  'valor_unitario': 414.62},
  {'classificacao_produto': 'carregador',
  'data_venda': ISODate('2018-09-05'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1d9'),
  'nome_cliente': 'ROBERTA DE LIMA',
  'nome_produto': 'Qualcomm Turbo 3A',
  'quantidade': 4,
  'valor_unitario': 36.5},
  {'classificacao_produto': 'tablet',
  'data_venda': ISODate('2018-04-11'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1da'),
  'nome_cliente': 'DEIVIDI SCALZAVARA',
  'nome_produto': 'Amazon Fire7',
  'quantidade': 2,
  'valor_unitario': 359.99},
  {'classificacao_produto': 'carregador',
  'data_venda': ISODate('2019-12-04'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1da'),
  'nome_cliente': 'DEIVIDI SCALZAVARA',
  'nome_produto': 'Qi wireless 10w',
  'quantidade': 1,
  'valor_unitario': 12.99},
  {'classificacao_produto': 'tablet',
  'data_venda': ISODate('2018-03-13'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1da'),
  'nome_cliente': 'DEIVIDI SCALZAVARA',
  'nome_produto': 'Multilaser M7S',
  'quantidade': 2,
  'valor_unitario': 375.5},
  {'classificacao_produto': 'headset',
  'data_venda': ISODate('2019-07-26'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1da'),
  'nome_cliente': 'DEIVIDI SCALZAVARA',
  'nome_produto': 'Apple Beats Studio',
  'quantidade': 1,
  'valor_unitario': 1599},
  {'classificacao_produto': 'headset',
  'data_venda': ISODate('2018-10-18'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1da'),
  'nome_cliente': 'DEIVIDI SCALZAVARA',
  'nome_produto': 'Sony MDR-5A',
  'quantidade': 1,
  'valor_unitario': 414.62},
  {'classificacao_produto': 'notebook',
  'data_venda': ISODate('2017-12-06'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1db'),
  'nome_cliente': 'ADOLFO NETO',
  'nome_produto': 'Alienware',
  'quantidade': 2,
  'valor_unitario': 12350.0},
  {'classificacao_produto': 'monitor',
  'data_venda': ISODate('2019-06-01'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1db'),
  'nome_cliente': 'ADOLFO NETO',
  'nome_produto': 'Philips LED 185',
  'quantidade': 2,
  'valor_unitario': 269.9},
  {'classificacao_produto': 'monitor',
  'data_venda': ISODate('2018-02-04'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1db'),
  'nome_cliente': 'ADOLFO NETO',
  'nome_produto': 'Samsung 32 Curve',
  'quantidade': 1,
  'valor_unitario': 2790.99},
  {'classificacao_produto': 'notebook',
  'data_venda': ISODate('2017-10-07'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1db'),
  'nome_cliente': 'ADOLFO NETO',
  'nome_produto': 'Alienware',
  'quantidade': 2,
  'valor_unitario': 12350.0},
  {'classificacao_produto': 'câmera digital',
  'data_venda': ISODate('2019-06-16'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1db'),
  'nome_cliente': 'ADOLFO NETO',
  'nome_produto': 'Leica V-lux t114',
  'quantidade': 2,
  'valor_unitario': 12300},
  {'classificacao_produto': 'smartphone',
  'data_venda': ISODate('2017-10-15'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1db'),
  'nome_cliente': 'ADOLFO NETO',
  'nome_produto': 'Xiaomi Redmi',
  'quantidade': 3,
  'valor_unitario': 768.89},
  {'classificacao_produto': 'câmera digital',
  'data_venda': ISODate('2018-11-23'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1dc'),
  'nome_cliente': 'JOSE MONESTEL',
  'nome_produto': 'Canon Rebel SL2',
  'quantidade': 1,
  'valor_unitario': 3000},
  {'classificacao_produto': 'câmera digital',
  'data_venda': ISODate('2019-12-27'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1dc'),
  'nome_cliente': 'JOSE MONESTEL',
  'nome_produto': 'Leica V-lux t114',
  'quantidade': 1,
  'valor_unitario': 12300},
  {'classificacao_produto': 'notebook',
  'data_venda': ISODate('2018-09-08'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1dc'),
  'nome_cliente': 'JOSE MONESTEL',
  'nome_produto': 'Mac Book Air',
  'quantidade': 1,
  'valor_unitario': 4680.0},
  {'classificacao_produto': 'smartphone',
  'data_venda': ISODate('2018-01-13'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1dc'),
  'nome_cliente': 'JOSE MONESTEL',
  'nome_produto': 'Galaxy s10',
  'quantidade': 3,
  'valor_unitario': 999.99},
  {'classificacao_produto': 'monitor',
  'data_venda': ISODate('2019-07-26'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1dd'),
  'nome_cliente': 'WAGNER CORREIA',
  'nome_produto': 'LG Led 20-M37',
  'quantidade': 2,
  'valor_unitario': 1289.0},
  {'classificacao_produto': 'monitor',
  'data_venda': ISODate('2018-06-19'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1dd'),
  'nome_cliente': 'WAGNER CORREIA',
  'nome_produto': 'Samsung 32 Curve',
  'quantidade': 2,
  'valor_unitario': 2790.99},
  {'classificacao_produto': 'smartphone',
  'data_venda': ISODate('2018-04-05'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1dd'),
  'nome_cliente': 'WAGNER CORREIA',
  'nome_produto': 'Galaxy s10',
  'quantidade': 1,
  'valor_unitario': 999.99},
  {'classificacao_produto': 'câmera digital',
  'data_venda': ISODate('2018-08-17'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1dd'),
  'nome_cliente': 'WAGNER CORREIA',
  'nome_produto': 'Nikon Coolpix S8100',
  'quantidade': 3,
  'valor_unitario': 899},
  {'classificacao_produto': 'smartphone',
  'data_venda': ISODate('2019-05-28'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1dd'),
  'nome_cliente': 'WAGNER CORREIA',
  'nome_produto': 'Moto G7 Play',
  'quantidade': 1,
  'valor_unitario': 829.9},
  {'classificacao_produto': 'tablet',
  'data_venda': ISODate('2019-06-09'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1dd'),
  'nome_cliente': 'WAGNER CORREIA',
  'nome_produto': 'Galaxy Tab A10',
  'quantidade': 2,
  'valor_unitario': 899},
  {'classificacao_produto': 'monitor',
  'data_venda': ISODate('2018-12-23'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1de'),
  'nome_cliente': 'JACEGUAY ZUKOSKI',
  'nome_produto': 'AOC 24 Freesync',
  'quantidade': 3,
  'valor_unitario': 619.29},
  {'classificacao_produto': 'tablet',
  'data_venda': ISODate('2018-01-02'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1de'),
  'nome_cliente': 'JACEGUAY ZUKOSKI',
  'nome_produto': 'iPad',
  'quantidade': 2,
  'valor_unitario': 2159.89},
  {'classificacao_produto': 'monitor',
  'data_venda': ISODate('2018-09-19'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1de'),
  'nome_cliente': 'JACEGUAY ZUKOSKI',
  'nome_produto': 'Samsung 32 Curve',
  'quantidade': 2,
  'valor_unitario': 2790.99},
  {'classificacao_produto': 'monitor',
  'data_venda': ISODate('2017-12-06'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1de'),
  'nome_cliente': 'JACEGUAY ZUKOSKI',
  'nome_produto': 'AOC 24 Freesync',
  'quantidade': 2,
  'valor_unitario': 619.29},
  {'classificacao_produto': 'tablet',
  'data_venda': ISODate('2019-10-05'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1de'),
  'nome_cliente': 'JACEGUAY ZUKOSKI',
  'nome_produto': 'Acer Iconia',
  'quantidade': 4,
  'valor_unitario': 499.0},
  {'classificacao_produto': 'headset',
  'data_venda': ISODate('2017-06-10'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1df'),
  'nome_cliente': 'MICHEL SOUZA',
  'nome_produto': 'Apple Beats Studio',
  'quantidade': 1,
  'valor_unitario': 1599},
  {'classificacao_produto': 'câmera digital',
  'data_venda': ISODate('2019-11-01'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1df'),
  'nome_cliente': 'MICHEL SOUZA',
  'nome_produto': 'Sony W800',
  'quantidade': 2,
  'valor_unitario': 659},
  {'classificacao_produto': 'tablet',
  'data_venda': ISODate('2017-11-24'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1df'),
  'nome_cliente': 'MICHEL SOUZA',
  'nome_produto': 'Galaxy Tab A10',
  'quantidade': 1,
  'valor_unitario': 899},
  {'classificacao_produto': 'headset',
  'data_venda': ISODate('2018-03-15'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1df'),
  'nome_cliente': 'MICHEL SOUZA',
  'nome_produto': 'Razer Kraken',
  'quantidade': 1,
  'valor_unitario': 328.9},
  {'classificacao_produto': 'headset',
  'data_venda': ISODate('2019-11-11'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1df'),
  'nome_cliente': 'MICHEL SOUZA',
  'nome_produto': 'Apple Beats Studio',
  'quantidade': 2,
  'valor_unitario': 1599},
  {'classificacao_produto': 'smartphone',
  'data_venda': ISODate('2019-12-20'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e0'),
  'nome_cliente': 'MAYRA RODRIGUES',
  'nome_produto': 'iPhone 11 pro',
  'quantidade': 3,
  'valor_unitario': 6899.0},
  {'classificacao_produto': 'headset',
  'data_venda': ISODate('2019-12-06'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e0'),
  'nome_cliente': 'MAYRA RODRIGUES',
  'nome_produto': 'Razer Kraken',
  'quantidade': 1,
  'valor_unitario': 328.9},
  {'classificacao_produto': 'headset',
  'data_venda': ISODate('2019-04-04'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e0'),
  'nome_cliente': 'MAYRA RODRIGUES',
  'nome_produto': 'AKG K92',
  'quantidade': 1,
  'valor_unitario': 219.9},
  {'classificacao_produto': 'notebook',
  'data_venda': ISODate('2017-11-27'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e0'),
  'nome_cliente': 'MAYRA RODRIGUES',
  'nome_produto': 'Positivo Motion',
  'quantidade': 1,
  'valor_unitario': 1450.0},
  {'classificacao_produto': 'tablet',
  'data_venda': ISODate('2017-12-10'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e0'),
  'nome_cliente': 'MAYRA RODRIGUES',
  'nome_produto': 'Amazon Fire7',
  'quantidade': 2,
  'valor_unitario': 359.99},
  {'classificacao_produto': 'carregador',
  'data_venda': ISODate('2018-05-04'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e0'),
  'nome_cliente': 'MAYRA RODRIGUES',
  'nome_produto': 'Universal 3 USB 3A',
  'quantidade': 3,
  'valor_unitario': 27.8},
  {'classificacao_produto': 'câmera digital',
  'data_venda': ISODate('2018-11-23'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e0'),
  'nome_cliente': 'MAYRA RODRIGUES',
  'nome_produto': 'Sony W800',
  'quantidade': 2,
  'valor_unitario': 659},
  {'classificacao_produto': 'câmera digital',
  'data_venda': ISODate('2017-08-05'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e1'),
  'nome_cliente': 'MICHEL DUARTE',
  'nome_produto': 'Leica V-lux t114',
  'quantidade': 2,
  'valor_unitario': 12300},
  {'classificacao_produto': 'câmera digital',
  'data_venda': ISODate('2019-05-03'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e1'),
  'nome_cliente': 'MICHEL DUARTE',
  'nome_produto': 'Leica V-lux t114',
  'quantidade': 2,
  'valor_unitario': 12300},
  {'classificacao_produto': 'monitor',
  'data_venda': ISODate('2018-03-07'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e1'),
  'nome_cliente': 'MICHEL DUARTE',
  'nome_produto': 'Philips LED 185',
  'quantidade': 3,
  'valor_unitario': 269.9},
  {'classificacao_produto': 'headset',
  'data_venda': ISODate('2019-05-11'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e1'),
  'nome_cliente': 'MICHEL DUARTE',
  'nome_produto': 'Razer Kraken',
  'quantidade': 1,
  'valor_unitario': 328.9},
  {'classificacao_produto': 'câmera digital',
  'data_venda': ISODate('2018-02-12'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e2'),
  'nome_cliente': 'MARCIO FOSSA',
  'nome_produto': 'Canon Rebel SL2',
  'quantidade': 2,
  'valor_unitario': 3000},
  {'classificacao_produto': 'tablet',
  'data_venda': ISODate('2018-11-17'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e2'),
  'nome_cliente': 'MARCIO FOSSA',
  'nome_produto': 'Multilaser M7S',
  'quantidade': 2,
  'valor_unitario': 375.5},
  {'classificacao_produto': 'headset',
  'data_venda': ISODate('2019-10-05'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e2'),
  'nome_cliente': 'MARCIO FOSSA',
  'nome_produto': 'AKG K92',
  'quantidade': 2,
  'valor_unitario': 219.9},
  {'classificacao_produto': 'monitor',
  'data_venda': ISODate('2017-09-03'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e2'),
  'nome_cliente': 'MARCIO FOSSA',
  'nome_produto': 'AOC 24 Freesync',
  'quantidade': 4,
  'valor_unitario': 619.29},
  {'classificacao_produto': 'headset',
  'data_venda': ISODate('2017-05-22'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e2'),
  'nome_cliente': 'MARCIO FOSSA',
  'nome_produto': 'Sony MDR-5A',
  'quantidade': 1,
  'valor_unitario': 414.62},
  {'classificacao_produto': 'monitor',
  'data_venda': ISODate('2017-02-19'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e2'),
  'nome_cliente': 'MARCIO FOSSA',
  'nome_produto': 'Samsung 32 Curve',
  'quantidade': 1,
  'valor_unitario': 2790.99},
  {'classificacao_produto': 'monitor',
  'data_venda': ISODate('2019-10-13'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e2'),
  'nome_cliente': 'MARCIO FOSSA',
  'nome_produto': 'LG Led 20-M37',
  'quantidade': 1,
  'valor_unitario': 1289.0},
  {'classificacao_produto': 'monitor',
  'data_venda': ISODate('2017-07-08'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e3'),
  'nome_cliente': 'MARCEL BORNANCIN',
  'nome_produto': 'Philips LED 185',
  'quantidade': 1,
  'valor_unitario': 269.9},
  {'classificacao_produto': 'câmera digital',
  'data_venda': ISODate('2017-02-11'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e3'),
  'nome_cliente': 'MARCEL BORNANCIN',
  'nome_produto': 'Nikon Coolpix S8100',
  'quantidade': 2,
  'valor_unitario': 899},
  {'classificacao_produto': 'notebook',
  'data_venda': ISODate('2017-04-20'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e3'),
  'nome_cliente': 'MARCEL BORNANCIN',
  'nome_produto': 'Dell XPS',
  'quantidade': 1,
  'valor_unitario': 7699.79},
  {'classificacao_produto': 'monitor',
  'data_venda': ISODate('2019-06-23'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e3'),
  'nome_cliente': 'MARCEL BORNANCIN',
  'nome_produto': 'Samsung 32 Curve',
  'quantidade': 1,
  'valor_unitario': 2790.99},
  {'classificacao_produto': 'headset',
  'data_venda': ISODate('2017-10-28'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e3'),
  'nome_cliente': 'MARCEL BORNANCIN',
  'nome_produto': 'Apple Beats Studio',
  'quantidade': 1,
  'valor_unitario': 1599},
  {'classificacao_produto': 'notebook',
  'data_venda': ISODate('2019-05-02'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e4'),
  'nome_cliente': 'ELOISA PERIN',
  'nome_produto': 'Lenovo Carbon',
  'quantidade': 2,
  'valor_unitario': 9999.98},
  {'classificacao_produto': 'headset',
  'data_venda': ISODate('2018-06-14'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e4'),
  'nome_cliente': 'ELOISA PERIN',
  'nome_produto': 'Sony MDR-5A',
  'quantidade': 4,
  'valor_unitario': 414.62},
  {'classificacao_produto': 'tablet',
  'data_venda': ISODate('2017-07-24'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e4'),
  'nome_cliente': 'ELOISA PERIN',
  'nome_produto': 'Acer Iconia',
  'quantidade': 1,
  'valor_unitario': 499.0},
  {'classificacao_produto': 'carregador',
  'data_venda': ISODate('2018-05-22'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e4'),
  'nome_cliente': 'ELOISA PERIN',
  'nome_produto': 'Qi wireless 10w',
  'quantidade': 3,
  'valor_unitario': 12.99},
  {'classificacao_produto': 'câmera digital',
  'data_venda': ISODate('2018-05-11'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e4'),
  'nome_cliente': 'ELOISA PERIN',
  'nome_produto': 'Sony W800',
  'quantidade': 2,
  'valor_unitario': 659},
  {'classificacao_produto': 'monitor',
  'data_venda': ISODate('2019-06-22'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e5'),
  'nome_cliente': 'TIAGO WIPPEL',
  'nome_produto': 'AOC 24 Freesync',
  'quantidade': 1,
  'valor_unitario': 619.29},
  {'classificacao_produto': 'monitor',
  'data_venda': ISODate('2019-11-14'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e5'),
  'nome_cliente': 'TIAGO WIPPEL',
  'nome_produto': 'LG Led 20-M37',
  'quantidade': 4,
  'valor_unitario': 1289.0},
  {'classificacao_produto': 'câmera digital',
  'data_venda': ISODate('2017-11-08'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e5'),
  'nome_cliente': 'TIAGO WIPPEL',
  'nome_produto': 'Sony W800',
  'quantidade': 1,
  'valor_unitario': 659},
  {'classificacao_produto': 'headset',
  'data_venda': ISODate('2018-06-04'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e5'),
  'nome_cliente': 'TIAGO WIPPEL',
  'nome_produto': 'Razer Kraken',
  'quantidade': 1,
  'valor_unitario': 328.9},
  {'classificacao_produto': 'monitor',
  'data_venda': ISODate('2018-01-21'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e6'),
  'nome_cliente': 'LUCAS FISCHER',
  'nome_produto': 'Samsung 32 Curve',
  'quantidade': 3,
  'valor_unitario': 2790.99},
  {'classificacao_produto': 'smartphone',
  'data_venda': ISODate('2019-02-20'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e6'),
  'nome_cliente': 'LUCAS FISCHER',
  'nome_produto': 'Moto G7 Play',
  'quantidade': 2,
  'valor_unitario': 829.9},
  {'classificacao_produto': 'notebook',
  'data_venda': ISODate('2019-11-25'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e6'),
  'nome_cliente': 'LUCAS FISCHER',
  'nome_produto': 'Positivo Motion',
  'quantidade': 2,
  'valor_unitario': 1450.0},
  {'classificacao_produto': 'tablet',
  'data_venda': ISODate('2018-07-26'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e6'),
  'nome_cliente': 'LUCAS FISCHER',
  'nome_produto': 'iPad',
  'quantidade': 1,
  'valor_unitario': 2159.89},
  {'classificacao_produto': 'notebook',
  'data_venda': ISODate('2019-01-03'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e6'),
  'nome_cliente': 'LUCAS FISCHER',
  'nome_produto': 'Lenovo Carbon',
  'quantidade': 2,
  'valor_unitario': 9999.98},
  {'classificacao_produto': 'monitor',
  'data_venda': ISODate('2017-11-08'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e7'),
  'nome_cliente': 'DIEGO PRANDO',
  'nome_produto': 'Philips LED 185',
  'quantidade': 1,
  'valor_unitario': 269.9},
  {'classificacao_produto': 'smartphone',
  'data_venda': ISODate('2017-03-07'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e7'),
  'nome_cliente': 'DIEGO PRANDO',
  'nome_produto': 'Moto G7 Play',
  'quantidade': 1,
  'valor_unitario': 829.9},
  {'classificacao_produto': 'notebook',
  'data_venda': ISODate('2018-07-14'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e7'),
  'nome_cliente': 'DIEGO PRANDO',
  'nome_produto': 'Positivo Motion',
  'quantidade': 4,
  'valor_unitario': 1450.0},
  {'classificacao_produto': 'tablet',
  'data_venda': ISODate('2018-10-04'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e7'),
  'nome_cliente': 'DIEGO PRANDO',
  'nome_produto': 'Amazon Fire7',
  'quantidade': 2,
  'valor_unitario': 359.99},
  {'classificacao_produto': 'tablet',
  'data_venda': ISODate('2019-09-09'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e7'),
  'nome_cliente': 'DIEGO PRANDO',
  'nome_produto': 'Acer Iconia',
  'quantidade': 1,
  'valor_unitario': 499.0},
  {'classificacao_produto': 'headset',
  'data_venda': ISODate('2018-12-15'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e7'),
  'nome_cliente': 'DIEGO PRANDO',
  'nome_produto': 'Sony MDR-5A',
  'quantidade': 1,
  'valor_unitario': 414.62},
  {'classificacao_produto': 'smartphone',
  'data_venda': ISODate('2018-04-18'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e7'),
  'nome_cliente': 'DIEGO PRANDO',
  'nome_produto': 'Galaxy s10',
  'quantidade': 2,
  'valor_unitario': 999.99},
  {'classificacao_produto': 'tablet',
  'data_venda': ISODate('2019-10-16'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e8'),
  'nome_cliente': 'ADRIANO WEIGUERT NAGASAVA',
  'nome_produto': 'Galaxy Tab A10',
  'quantidade': 1,
  'valor_unitario': 899},
  {'classificacao_produto': 'smartphone',
  'data_venda': ISODate('2017-12-06'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e8'),
  'nome_cliente': 'ADRIANO WEIGUERT NAGASAVA',
  'nome_produto': 'Galaxy s10',
  'quantidade': 1,
  'valor_unitario': 999.99},
  {'classificacao_produto': 'notebook',
  'data_venda': ISODate('2018-08-16'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e8'),
  'nome_cliente': 'ADRIANO WEIGUERT NAGASAVA',
  'nome_produto': 'Positivo Motion',
  'quantidade': 3,
  'valor_unitario': 1450.0},
  {'classificacao_produto': 'câmera digital',
  'data_venda': ISODate('2017-04-16'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e8'),
  'nome_cliente': 'ADRIANO WEIGUERT NAGASAVA',
  'nome_produto': 'Nikon Coolpix S8100',
  'quantidade': 2,
  'valor_unitario': 899},
  {'classificacao_produto': 'headset',
  'data_venda': ISODate('2018-10-17'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e8'),
  'nome_cliente': 'ADRIANO WEIGUERT NAGASAVA',
  'nome_produto': 'AKG K92',
  'quantidade': 1,
  'valor_unitario': 219.9},
  {'classificacao_produto': 'notebook',
  'data_venda': ISODate('2017-03-01'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e8'),
  'nome_cliente': 'ADRIANO WEIGUERT NAGASAVA',
  'nome_produto': 'Mac Book Air',
  'quantidade': 3,
  'valor_unitario': 4680.0},
  {'classificacao_produto': 'carregador',
  'data_venda': ISODate('2017-10-21'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e9'),
  'nome_cliente': 'FERNANDO MIRANDA',
  'nome_produto': 'Universal 3 USB 3A',
  'quantidade': 1,
  'valor_unitario': 27.8},
  {'classificacao_produto': 'smartphone',
  'data_venda': ISODate('2017-03-15'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e9'),
  'nome_cliente': 'FERNANDO MIRANDA',
  'nome_produto': 'Xiaomi Redmi',
  'quantidade': 1,
  'valor_unitario': 768.89},
  {'classificacao_produto': 'smartphone',
  'data_venda': ISODate('2019-02-25'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e9'),
  'nome_cliente': 'FERNANDO MIRANDA',
  'nome_produto': 'Xiaomi Redmi',
  'quantidade': 2,
  'valor_unitario': 768.89},
  {'classificacao_produto': 'smartphone',
  'data_venda': ISODate('2017-01-14'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e9'),
  'nome_cliente': 'FERNANDO MIRANDA',
  'nome_produto': 'Xiaomi Redmi',
  'quantidade': 2,
  'valor_unitario': 768.89},
  {'classificacao_produto': 'câmera digital',
  'data_venda': ISODate('2019-07-27'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1e9'),
  'nome_cliente': 'FERNANDO MIRANDA',
  'nome_produto': 'Sony W800',
  'quantidade': 1,
  'valor_unitario': 659},
  {'classificacao_produto': 'monitor',
  'data_venda': ISODate('2018-08-08'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1ea'),
  'nome_cliente': 'LUIS MONTES',
  'nome_produto': 'LG Led 20-M37',
  'quantidade': 1,
  'valor_unitario': 1289.0},
  {'classificacao_produto': 'smartphone',
  'data_venda': ISODate('2018-08-07'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1ea'),
  'nome_cliente': 'LUIS MONTES',
  'nome_produto': 'Galaxy s10',
  'quantidade': 2,
  'valor_unitario': 999.99},
  {'classificacao_produto': 'headset',
  'data_venda': ISODate('2019-11-03'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1ea'),
  'nome_cliente': 'LUIS MONTES',
  'nome_produto': 'Apple Beats Studio',
  'quantidade': 2,
  'valor_unitario': 1599},
  {'classificacao_produto': 'notebook',
  'data_venda': ISODate('2018-02-18'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1ea'),
  'nome_cliente': 'LUIS MONTES',
  'nome_produto': 'Mac Book Air',
  'quantidade': 1,
  'valor_unitario': 4680.0},
  {'classificacao_produto': 'smartphone',
  'data_venda': ISODate('2018-09-07'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1eb'),
  'nome_cliente': 'MARCELO DE SOUZA',
  'nome_produto': 'iPhone 11 pro',
  'quantidade': 1,
  'valor_unitario': 6899.0},
  {'classificacao_produto': 'monitor',
  'data_venda': ISODate('2019-10-01'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1eb'),
  'nome_cliente': 'MARCELO DE SOUZA',
  'nome_produto': 'Philips LED 185',
  'quantidade': 1,
  'valor_unitario': 269.9},
  {'classificacao_produto': 'carregador',
  'data_venda': ISODate('2019-12-20'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1eb'),
  'nome_cliente': 'MARCELO DE SOUZA',
  'nome_produto': 'Qi wireless 10w',
  'quantidade': 1,
  'valor_unitario': 12.99},
  {'classificacao_produto': 'headset',
  'data_venda': ISODate('2018-03-06'),
  'id_cliente': ObjectId('5dc58145cfb83d37c2e6d1eb'),
  'nome_cliente': 'MARCELO DE SOUZA',
  'nome_produto': 'Apple Beats Studio',
  'quantidade': 4,
  'valor_unitario': 1599}
])


/**
 * 4. Listar apenas os produtos da categoria “smartphone”.
 */
db.vendas.find({"classificacao_produto": "smartphone"})


/**
 * 5. Calcular a média dos valores apenas da categoria “notebook”.
 */
db.vendas.aggregate([
  {$match : { "classificacao_produto" : "notebook" } },
  {$group: {
      _id: "$classificacao_produto",
      media: { $avg: { $multiply: [ "$valor_unitario", "$quantidade" ] } }
    }
  }
])


/**
 * 6. Filtrar apenas os produtos vendidos entre a data “01/10/2018” e a data “01/04/2019”.
 */
db.vendas.find({
  "data_venda": {$gte: ISODate("2018-10-01T00:00:00"), $lte: ISODate("2019-04-01T00:00:00")}
})


/**
 * 7. Contar quantos produtos foram vendidos de cada categoria.
 */
db.vendas.aggregate([
  {$group: {
      _id: "$classificacao_produto",
      subtotal: { $sum: "$quantidade" } 
    }
  }
])


/**
 * 8. Ordenar as vendas pela data em ordem decrescente.
 * 
 * @see https://docs.mongodb.com/manual/reference/operator/meta/orderby/index.html
 */
// MongoDB 3.2 ou superior
db.vendas.find().sort({"data_venda": -1})

// MongoDB inferior ao 3.2 (deprecated)
db.collection.find()._addSpecial("$orderby", {"data_venda" : -1})
db.collection.find({$query: {}, $orderby: {"data_venda" : -1}})


/**
 * 9. Calcular o valor total dos produtos vendidos em cada categoria
 */
db.vendas.aggregate([
  {$group: {
      _id: "$classificacao_produto",
      subtotal: { $sum: { $multiply: [ "$quantidade", "$valor_unitario"]} } 
    }
  }
])


/**
 * 10. Calcular o desvio padrão de preços dos produtos de cada categoria.
 */
db.vendas.aggregate([
  {$group: {
      _id: "$classificacao_produto",
      desvio_padrao: { $stdDevPop: "$valor_unitario" } 
    }
  }
])


/**
 * 11. Calcular o valor total de produtos vendidos para cada cliente.
 */
db.vendas.aggregate([
  {$group: {
      _id: "$nome_cliente",
      subtotal: { $sum: { $multiply: [ "$quantidade", "$valor_unitario"]} } 
    }
  }
])


/**
 * 12. Calcular o valor total de produtos vendidos, por países, de acordo com a origem do cliente.
 */
db.cliente.aggregate([{
    $lookup:{
      from: "vendas",
      localField: "_id",
      foreignField: "id_cliente",
      as: "vendas"
    }
  },
  {"$unwind": "$vendas"},
  {$group: {
    _id: "$endereco.cidade",
    totalValor: { 
      $sum: {$multiply: ["$vendas.quantidade", "$vendas.valor_unitario"]}
    }
  }}
])
